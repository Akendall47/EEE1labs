# Lab Skills
## Part 1
## Section 3 - Sinusoids

Sinusoidal signals are an important class of signal in electronics and signal processing.
In this part of the experiment, we will use a sine signal to achieve a smooth side to side sweep of the antennae.
The sine wave will be generated by the signal generator (also know as arbitrary waveform generator) in the PicoScope.

| Description | Quantity | 
| -------- | ----------- |
| **Modules and assemblies** |
| EEEBug Chassis Assembly | 1 |
| **Equipment** |
| Oscilloscope | 1 |
| **Electronic components** |
| 3 way 2.54mm header | 2 |
| 33kŒ© resistor‚Ä† | 1 |
| 68kŒ© resistor‚Ä† | 1 |
| 1ŒºF ceramic capacitor‚Ä† | 1 |
| **Wires and cables** |
| USB Cable | 1 |
| **Software** |
| Arduino IDE |
| Fritzing |
| **Downloads** |
| `phase-shift.fz` Fritzing project |
| `twoservosin.fz` Fritzing project |
| `servo.ino` Arduino Sketch |

*‚Ä†Collect from lab component drawers*

### Before the lab
[Watch this video about using the oscilloscope function generator](https://imperial.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=17f83d22-ac33-4d37-8c64-aada00d16a17)
	
### Generate a sine wave
	
First you need to calculate the characteristics of the sine wave ‚Äî if a voltage is represented by the function y = A sin(œât) + c, then the parameters A, œâ and c define its characteristics:
* A is the amplitude and will represent the angular range of motion of the motor. Use your measurements from the previous section to find the voltage that will achieve approximately 30¬∞ total rotation range, i.e ¬±15¬∞ from the centre position.
* œâ is the angular velocity ‚Äî this should be chosen to give an oscillation frequency of 1Hz, bearing in mind that the relationship between angular velocity and frequency is œâ=2ùúãf.
* c is a constant, also known as a *DC offset*. It is needed because a pure sine function will give a negative output at times and the input voltage to the Orangepip must be in the range 0‚Äì5V. Use c=1V, which is the maximum DC offset of the PicoScope signal generator.

		
Open the signal generator configuration window using the appropriate button in the toolbar of the PicoScope user interface:

	    \includegraphics[height=1cm]{graphics/pico-siggen}
	    
	    \footnotesize\centering
	    \emph{Signal generator configuration button}

		
In the configuration window you'll find options for setting the type of waveform to generate along with the appropriate parameters.
Set it up to generate a sine function with 1Hz frequency, 1V offset and the amplitude you calculated to give the desired range of motion.
Connect a BNC‚Äîtest clip lead to the output connector labelled `AWG', and connect the oscilloscope probe to the clips so that the PicoScope is measuring its own output.
		
View the sine waveform on the PicoScope.
You'll need to set the timebase to be able to see the entire waveform.
Note that the time axis of the oscilloscope will now represent at least one second of time and so the update rate of the screen will be quite low.
Allow time for the screen to update following an adjustment before making further changes to the controls.
Choose an appropriate trigger voltage by moving the trigger symbol to the middle of the expected voltage range (1V).
You can freeze the display by pressing the stop button (red square) or choosing `single' in the trigger mode.
		
Use the cursors to confirm that the characteristics of the sine signal are correct. Since the sine signal is symmetric you can determine the offset by taking the mean of the maximum and minimum voltages.
		
	    {\centering
	    \includegraphics[height=8cm]{graphics/pico-sine}
	    
	    \footnotesize\centering
	    \emph{Sine signal observed with a PicoScope}
	    }
		
Connect the sine signal to the input pin of the Orangepip, disconnecting the potentiometer that you used before. Power up the circuit and check that the servo motor moves as expected. Use the oscilloscope to verify that the pulse width of the servo motor control signal is varying as the motor moves.
	
- [ ] Set up the function generator on the oscilloscope to create a sine signal and view it with the oscilloscope. Use it to control the pan axis of the pan and tilt module. Suggested logbook entry: oscilloscope screenshot of sine wave.

### Make a phase shifter
	
There is only one signal generator output so we'll use a *phase shift* of the sine wave to control the second servo motor.
A phase shift is represented mathematically by adding a time offset œÜ to the sine function so it becomes y = A sin(œât+œÜ) + c.
	    
A phase shift can be implemented quite easily using the circuit in the Fritzing project `phase-shift`.
You will learn how it works in detail soon, but for now think of it as integrating the sine function thanks to the capacitor equation V(t)=1/C ‚à´ I(t) dt.
Integrating sine produces a cosine, which is equal to a phase-shifted sine.
Build the circuit on the breadboard and connect the phase shifter output to the second oscilloscope probe, so that you can compare the input and output of the circuit.
		
Set up channel A to display the input sine signal as before and then add the second oscilloscope channel by connecting the second oscilloscope probe and changing the mode of Channel B from `off' to `Auto'
You should now see two sinusoids on the oscilloscope screen with a time lag between them.
		
	    {\centering
	    \includegraphics[height=8cm]{graphics/pico-phase}
	    
	    \footnotesize\centering
	    \emph{Sine signal with phase shift}
	    }
		
Use the time axis cursors to measure the time difference between the signals.
From this calculate the phase difference in radians according to the formula œÜ = 2ùúãt/T, where t is the time difference and T is the period of the signal.
Try changing the value of the resistor in the circuit to find the effect on the phase.
A drawback of this circuit is that the amplitude of the output signal is less than the input; this is known as *attenuation*.
You'll also find that the amount of phase shift and the attenuation vary with the frequency of the input.

- [ ] Build the phase-shift circuit on the breadboard and use oscilloscope cursors to measure the phase difference between the input and output sinusoids. Suggested logbook entry: screenshot of sine waves with phase difference

You can use your two sine signals with a phase shift to control your antennae.
Connect them to the Orangepip inputs A0 and A1, like you did with the potentiometer outputs in [Section 2](https://github.com/edstott/EEE1labs/blob/main/skills/section2.md#challenge-two-servo-motors).
Connect the two servo motors to pins 9 and 11 via the breadboard the same as before.
Refer to the design in `twoservosin.fz`.
		
- [ ] Connect the sine wave and phase-shifted sine wave to the Orangepip and observe the effect of the motors moving out of phase. Suggested logbook entry: video of the antennae moving.
	
### Challenge: more signals
You may have noticed that the oscilloscope can generate other types of signal.
You can try using the signals to control the servo motors via the Orangepip, but make sure to respect the 0--5V input voltage limit of the Orangepip.
Measure the maximum and minimum voltage peaks before connecting the signal to the Orangepip.
			
Try the following exercises on the oscilloscope:
1. Set up a square wave signal with 5kHz frequency, 1V amplitude and 1V offset. The rise time of a digital signal is the time taken for the signal to change from 10\% to 90\% of the final voltage during a transition. Likewise, the fall time is measured from 90\% to 10\%. Measure these values by zooming in with the timebase until the edges become slopes and using the cursors.
2. Set up a sine signal with 25kHz frequency, 20mV amplitude and 1V offset. You will find it hard to see the sine function because the amplitude is small compared to the DC offset. Try changing the input channel mode from DC to AC. What does this do and how is it useful? Remember to move the trigger marker so it lies within the waveform.
3. Set up a triangle wave with 1kHz frequency, 1V amplitude and 0V offset. Instead of adjusting the timebase manually, try pressing the `Auto Setup' button. This is a handy shortcut but always take care because the scope might decide to focus on some kind of noise instead of the signal you intended. Always check the vertical and horizontal scales are a reasonable value after using Auto Setup.
4. The signal generator has other waveform options. Generate them and display them on the oscilloscope to find out what they look like, and try to find out why the might occur in electronic systems.

- [ ] Suggested logbook entries: oscilloscope screenshot of each signal plus discussion of questions. 
